<main class="container" id="main" style="padding:4rem 0;">
  <h1 style="font-size:3rem;text-align:center">Donate = Instant Role</h1>
  <p style="text-align:center;font-size:1.2rem;color:#94a3b8">
    Connect your Discord to see donation packs!
  </p>

  <!-- ✅ donation packs (hidden by default) -->
  <div id="packs" style="display:none; gap:2rem; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); margin-top:3rem">
    <!-- Starter -->
    <div class="card">
      <h3>Starter Pack – $5</h3>
      <ul style="list-style:none;padding:0;margin:1rem 0;">
        <li>✔ Donor chat</li>
        <li>✔ Starter role</li>
        <li>✔ Priority Support</li>
      </ul>
      <button class="btn btn-outline wide" onclick="pay('Starter',5)">Pay $5</button>
    </div>

    <!-- Founder -->
    <div class="card">
      <div class="ribbon">POPULAR</div>
      <h3>Founder Pack – $10</h3>
      <ul style="list-style:none;padding:0;margin:1rem 0;">
        <li>✔ Everything in Starter</li>
        <li>✔ Gold Founder badge</li>
        <li>✔ Name changes</li>
      </ul>
      <button class="btn btn-primary wide" onclick="pay('Founder',10)">Pay $10</button>
    </div>

    <!-- Ultimate -->
    <div class="card">
      <h3>Ultimate Donator – $15</h3>
      <ul style="list-style:none;padding:0;margin:1rem 0;">
        <li>✔ Full Locker</li>
        <li>✔ Private VC</li>
        <li>✔ Everything from above packs</li>
      </ul>
      <button class="btn btn-outline wide" onclick="pay('ULTIMATE',15)">Pay $15</button>
    </div>
  </div>
</main>

<script>
const discordBtn = document.getElementById("discordBtn");
const packsDiv = document.getElementById("packs");
const CLIENT_ID = "1435865601196294204";
const REDIRECT = encodeURIComponent(window.location.origin + window.location.pathname);

// Connect Discord (cosmetic)
discordBtn.onclick = () => {
  if (localStorage.discordTag) {
    localStorage.clear();
    packsDiv.style.display = "none";
    location.reload();
    return;
  }
  const url = `https://discord.com/oauth2/authorize?client_id=${CLIENT_ID}&redirect_uri=${REDIRECT}&response_type=token&scope=identify`;
  window.location.href = url;
};

function showPacks() {
  packsDiv.style.display = "grid";
  document.querySelector('p').textContent = "Click a pack to pay!";
}

// Handle OAuth redirect
if (location.hash.includes("access_token")) {
  const token = new URLSearchParams(location.hash.slice(1)).get("access_token");
  fetch("https://discord.com/api/users/@me", {
    headers: { Authorization: `Bearer ${token}` }
  })
  .then(r => r.json())
  .then(u => {
    localStorage.discordTag = u.username;
    discordBtn.textContent = `Connected: ${u.username}`;
    discordBtn.style.background = "transparent";
    history.replaceState({}, "", location.pathname);
    showPacks();
  })
  .catch(() => alert("Failed to connect Discord"));
}

// Show packs if user already connected
if (localStorage.discordTag) {
  discordBtn.textContent = `Connected: ${localStorage.discordTag}`;
  discordBtn.style.background = "transparent";
  showPacks();
}

// Pay function (replace with your payment link)
function pay(pack, amount) {
  let paymentUrl = `https://your-payment-site.com/pay?pack=${pack}&amount=${amount}`;
  window.open(paymentUrl, "_blank");
}
</script>
